import{r as a,j as n,z as x,o as p,V as v,W as tt,D as et}from"./main-BCi_6bsg.js";import{C as nt}from"./calendar-BRkHNbUj.js";import{P as st,a as rt,b as ot}from"./popover-Ck0n1JDs.js";import{t as u,e as b,f as O,s as at,g as ct}from"./format-Cqurfn0V.js";import{s as F}from"./startOfMonth-DJd5xGZa.js";function it(t,e){const s=u(t);return isNaN(e)?b(t,NaN):(s.setDate(s.getDate()+e),s)}function ft(t,e){const s=u(t);if(isNaN(e))return b(t,NaN);if(!e)return s;const o=s.getDate(),c=b(t,s.getTime());c.setMonth(s.getMonth()+e+1,0);const f=c.getDate();return o>=f?c:(s.setFullYear(c.getFullYear(),c.getMonth(),o),s)}function dt(t,e){const s=e*7;return it(t,s)}function lt(t){const e=u(t);return e.setHours(23,59,59,999),e}function $(t){const e=u(t),s=e.getMonth();return e.setFullYear(e.getFullYear(),s+1,0),e.setHours(23,59,59,999),e}function mt(t,e){const s=e?.weekStartsOn,o=u(t),c=o.getDay(),f=(c<s?-7:0)+6-(c-s);return o.setDate(o.getDate()+f),o.setHours(23,59,59,999),o}function j(t,e){return ft(t,-e)}function z(t,e){return dt(t,-1)}const ut=()=>{const t=new Date;return[{label:"Hôm nay",range:{from:at(t),to:lt(t)}},{label:"Tuần trước",range:{from:ct(z(t),{weekStartsOn:1}),to:mt(z(t),{weekStartsOn:1})}},{label:"Tháng trước",range:{from:F(j(t,1)),to:$(j(t,1))}},{label:"3 tháng trước",range:{from:F(j(t,3)),to:$(j(t,3))}}]};function yt({value:t,onChange:e,placeholder:s={from:"From date",to:"To date"},dateFormat:o="dd/MM/yyyy",presets:c,showPresets:f,label:h,error:g,required:A,disabled:y=!1,disabledPast:S=!1,disabledFuture:P=!1,onDisabled:D,size:L="md",className:R,triggerClassName:V,popoverClassName:B,locale:d,cancelText:I,applyText:q,...H}){const[M,N]=a.useState(!1),[w,l]=a.useState(t),[k,i]=a.useState(()=>t?.to||t?.from||new Date),T=a.useRef(t),W=a.useRef(t?.to||t?.from||new Date);a.useEffect(()=>{M&&(T.current=t,W.current=t?.to||t?.from||new Date,l(t),t?.to?i(t.to):t?.from?i(t.from):i(new Date))},[M,t]),a.useEffect(()=>{l(t),t?.to?i(t.to):t?.from&&i(t.from)},[t]);const E=a.useCallback(r=>{if(y)return!0;const m=new Date;m.setHours(0,0,0,0);const C=new Date(r);return C.setHours(0,0,0,0),S&&C<m||P&&C>m?!0:D?D(r):!1},[y,S,P,D]),G=a.useMemo(()=>ut(),[]),Y=c??G,J=f!==void 0?f:Y.length>0,K=()=>{e?.(w),N(!1)},Q=()=>{l(T.current),i(W.current),N(!1)},U=r=>{l(r.range),r.range.to?i(r.range.to):r.range.from&&i(r.range.from)},X=a.useMemo(()=>{if(!t?.from)return s.from||"Pick a date";const r=d&&typeof d!="string"?{locale:d}:void 0;return t.from&&t.to?`${O(t.from,o,r)} - ${O(t.to,o,r)}`:O(t.from,o,r)},[t,o,s,d]),Z=a.useMemo(()=>({...H,mode:"range",selected:w,onSelect:l,defaultMonth:k,month:k,onMonthChange:i,disabled:E,captionLayout:"dropdown",startMonth:new Date(1890,0,1),endMonth:new Date(new Date().getFullYear()+50,11,31),locale:d}),[H,w,k,E,d]),_=n.jsxs(st,{open:M,onOpenChange:N,children:[n.jsx(rt,{asChild:!0,children:n.jsxs(x,{variant:"outline",size:L,disabled:y,className:p("group w-full justify-between",!t?.from&&"text-muted-foreground",g&&"border-destructive",V),children:[n.jsx("span",{children:X}),n.jsx(v,{className:"h-4 w-4 opacity-50"})]})}),n.jsx(ot,{className:p("flex w-auto flex-col gap-2 p-0 pb-2",B),align:"start",children:n.jsxs("div",{className:"flex flex-col gap-2 pb-2",children:[n.jsxs("div",{className:"flex",children:[J&&n.jsx("div",{className:"border-r p-2 w-fit",children:n.jsx("div",{className:"space-y-1",children:Y.map((r,m)=>n.jsx(x,{variant:"ghost",size:"sm",className:"block text-left font-normal",onClick:()=>U(r),children:r.label},m))})}),n.jsx("div",{className:"flex-1",children:n.jsx(nt,{initialFocus:!0,...Z})})]}),n.jsx(tt,{}),n.jsxs("div",{className:"flex justify-end gap-2 px-2",children:[n.jsx(x,{variant:"secondary",onClick:Q,children:I||"Cancel"}),n.jsx(x,{onClick:K,children:q||"Apply"})]})]})})]});return h||g?n.jsxs("div",{className:p("w-full",R),children:[h&&n.jsxs(et,{className:"text-foreground leading-5 block",children:[h,A&&n.jsx("span",{className:"text-destructive",children:"*"})]}),n.jsx("div",{className:h?"mt-1":"",children:_}),g&&n.jsx("div",{className:"text-destructive text-sm mt-1.5",role:"alert",children:g})]}):n.jsx("div",{className:p("w-full",R),children:_})}export{yt as D};
