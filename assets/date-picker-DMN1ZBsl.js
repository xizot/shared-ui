import{r as s,j as n,o as x,U as I,z as V,V as rt,W as nt,D as st}from"./main-BCi_6bsg.js";import{C as ot}from"./calendar-BRkHNbUj.js";import{s as Y}from"./startOfMonth-DJd5xGZa.js";import{P as ct,a as it,b as at}from"./popover-Ck0n1JDs.js";import{t as v,f as R}from"./format-Cqurfn0V.js";function G(t,a){const i=v(t);return i.setHours(a),i}function J(t,a){const i=v(t);return i.setMinutes(a),i}function K(t,a){const i=v(t);return i.setSeconds(a),i}function lt({value:t,onChange:a,locale:i,monthNames:p,disabled:l,className:u}){const[o,h]=s.useState(()=>t?t.getFullYear():new Date().getFullYear()),[d,j]=s.useState(()=>t?t.getMonth():new Date().getMonth()),g=s.useRef(null),S=s.useRef(null);s.useEffect(()=>{if(t){const e=t.getFullYear(),r=t.getMonth();(o!==e||d!==r)&&(h(e),j(r))}else{const e=new Date,r=e.getFullYear(),c=e.getMonth();(o!==r||d!==c)&&(h(r),j(c))}},[t]),s.useEffect(()=>{if(!g.current)return;const e=setTimeout(()=>{const r=g.current?.querySelector(`[data-month="${d}"]`);if(r&&g.current){const c=g.current.closest('[data-slot="scroll-area-viewport"]');if(c){const m=r.offsetTop;c.scrollTo({top:m,behavior:"smooth"})}}},100);return()=>clearTimeout(e)},[d]),s.useEffect(()=>{if(!S.current)return;const e=setTimeout(()=>{const r=S.current?.querySelector(`[data-year="${o}"]`);if(r&&S.current){const c=S.current.closest('[data-slot="scroll-area-viewport"]');if(c){const m=r.offsetTop;c.scrollTo({top:m,behavior:"smooth"})}}},100);return()=>clearTimeout(e)},[o]);const C=s.useCallback(e=>{j(e);const r=new Date(o,e,1);a(Y(r))},[o,a]),N=s.useCallback(e=>{h(e);const r=new Date(e,d,1);a(Y(r))},[d,a]),M=s.useMemo(()=>{if(p&&p.length===12)return p;const e=typeof i=="string"?i:i?.code||"en-US",r=new Intl.DateTimeFormat(e,{month:"long"});return Array.from({length:12},(c,m)=>{const _=new Date(2024,m,1);return r.format(_)})},[i,p]),b=s.useMemo(()=>Array.from({length:100},(e,r)=>new Date().getFullYear()-50+r),[]),E=s.useMemo(()=>t?`${M[d]} ${o}`:`${M[new Date().getMonth()]} ${new Date().getFullYear()}`,[t,M,d,o]);return n.jsxs("div",{className:x("flex flex-col h-full",u),children:[n.jsx("div",{className:"px-4 py-3 text-center shrink-0",children:n.jsx("div",{className:"font-medium text-lg",children:E})}),n.jsxs("div",{className:"flex flex-1 min-h-0 gap-0.5",children:[n.jsx(I,{className:"w-30 [&>[data-slot=scroll-area-viewport]]:rounded-l-md overflow-hidden",children:n.jsx("div",{ref:g,className:"px-2",children:M.map((e,r)=>{const c=d===r,m=l?l(new Date(o,r,1)):!1;return n.jsx("div",{"data-month":r,onClick:()=>!m&&C(r),className:x("px-2 py-1.5 text-center cursor-pointer text-sm transition-colors rounded-md",c?"bg-secondary":"hover:bg-accent",m&&"opacity-50 cursor-not-allowed"),children:e},r)})})}),n.jsx(I,{className:"flex-1 [&>[data-slot=scroll-area-viewport]]:rounded-r-md overflow-hidden",children:n.jsx("div",{ref:S,className:"px-2",children:b.map(e=>{const r=o===e;return n.jsx("div",{"data-year":e,onClick:()=>N(e),className:x("px-2 py-1.5 text-center cursor-pointer text-sm transition-colors rounded-md",r?"bg-secondary":"hover:bg-accent"),children:e},e)})})})]})]})}function Q({value:t,onChange:a,showSeconds:i=!0,className:p}){const l=s.useRef(null),u=s.useRef(null),o=s.useRef(null),h=parseInt(t.hour,10)||0,d=parseInt(t.minute,10)||0,j=parseInt(t.second,10)||0,g=Array.from({length:24},(e,r)=>r),S=Array.from({length:60},(e,r)=>r),C=Array.from({length:60},(e,r)=>r);s.useEffect(()=>{const e=setTimeout(()=>{if(l.current){const r=l.current.querySelector(`[data-hour="${h}"]`);if(r){const c=l.current.closest('[data-slot="scroll-area-viewport"]');if(c){const m=r.offsetTop;c.scrollTo({top:m,behavior:"smooth"})}}}},100);return()=>clearTimeout(e)},[h]),s.useEffect(()=>{const e=setTimeout(()=>{if(u.current){const r=u.current.querySelector(`[data-minute="${d}"]`);if(r){const c=u.current.closest('[data-slot="scroll-area-viewport"]');if(c){const m=r.offsetTop;c.scrollTo({top:m,behavior:"smooth"})}}}},100);return()=>clearTimeout(e)},[d]),s.useEffect(()=>{if(!i)return;const e=setTimeout(()=>{if(o.current){const r=o.current.querySelector(`[data-second="${j}"]`);if(r){const c=o.current.closest('[data-slot="scroll-area-viewport"]');if(c){const m=r.offsetTop;c.scrollTo({top:m,behavior:"smooth"})}}}},100);return()=>clearTimeout(e)},[j,i]);const N=e=>{a({...t,hour:e.toString().padStart(2,"0")})},M=e=>{a({...t,minute:e.toString().padStart(2,"0")})},b=e=>{a({...t,second:e.toString().padStart(2,"0")})},E=`${t.hour}:${t.minute}${i?`:${t.second}`:""}`;return n.jsxs("div",{className:x("flex flex-col h-full border-l",p),children:[n.jsx("div",{className:"px-4 py-3 text-center shrink-0",children:n.jsx("div",{className:"font-medium text-lg",children:E})}),n.jsxs("div",{className:"flex flex-1 min-h-0 gap-0.5",children:[n.jsx(I,{className:"flex-1 w-16 [&>[data-slot=scroll-area-viewport]]:rounded-l-md overflow-hidden",children:n.jsx("div",{ref:l,className:"px-2",children:g.map(e=>n.jsx("div",{"data-hour":e,onClick:()=>N(e),className:x("px-2 py-1.5 text-center cursor-pointer text-sm transition-colors rounded-md",h===e?"bg-secondary":"hover:bg-accent"),children:e.toString().padStart(2,"0")},e))})}),n.jsx(I,{className:"flex-1 w-16 [&>[data-slot=scroll-area-viewport]]:overflow-hidden",children:n.jsx("div",{ref:u,className:"px-2",children:S.map(e=>n.jsx("div",{"data-minute":e,onClick:()=>M(e),className:x("px-2 py-1.5 text-center cursor-pointer text-sm transition-colors rounded-md",d===e?"bg-secondary":"hover:bg-accent"),children:e.toString().padStart(2,"0")},e))})}),i&&n.jsx(I,{className:"flex-1 w-16 [&>[data-slot=scroll-area-viewport]]:rounded-r-md overflow-hidden",children:n.jsx("div",{ref:o,className:"px-2",children:C.map(e=>n.jsx("div",{"data-second":e,onClick:()=>b(e),className:x("px-2 py-1.5 text-center cursor-pointer text-sm transition-colors rounded-md",j===e?"bg-secondary":"hover:bg-accent"),children:e.toString().padStart(2,"0")},e))})})]})]})}function ht({value:t,onChange:a,placeholder:i="Pick a date",dateFormat:p="dd/MM/yyyy",showTime:l=!1,timeOnly:u=!1,mode:o="single",label:h,error:d,required:j,disabled:g=!1,disabledPast:S=!1,disabledFuture:C=!1,onDisabled:N,size:M="md",className:b,triggerClassName:E,popoverClassName:e,locale:r,cancelText:c,applyText:m,monthNames:_,...z}){const[H,F]=s.useState(!1),[T,k]=s.useState(t),[P,$]=s.useState(()=>t||new Date),[D,w]=s.useState(()=>t?{hour:t.getHours().toString().padStart(2,"0"),minute:t.getMinutes().toString().padStart(2,"0"),second:t.getSeconds().toString().padStart(2,"0")}:{hour:"00",minute:"00",second:"00"}),U=s.useRef(t),L=s.useRef(t||new Date),X=()=>t?{hour:t.getHours().toString().padStart(2,"0"),minute:t.getMinutes().toString().padStart(2,"0"),second:t.getSeconds().toString().padStart(2,"0")}:{hour:"00",minute:"00",second:"00"},W=s.useRef(X());s.useEffect(()=>{H&&(U.current=t,L.current=t||new Date,W.current=t?{hour:t.getHours().toString().padStart(2,"0"),minute:t.getMinutes().toString().padStart(2,"0"),second:t.getSeconds().toString().padStart(2,"0")}:{hour:"00",minute:"00",second:"00"},u?w(t?{hour:t.getHours().toString().padStart(2,"0"),minute:t.getMinutes().toString().padStart(2,"0"),second:t.getSeconds().toString().padStart(2,"0")}:{hour:"00",minute:"00",second:"00"}):o==="month"?k(t?Y(t):Y(new Date)):(k(t),t?($(t),l&&w({hour:t.getHours().toString().padStart(2,"0"),minute:t.getMinutes().toString().padStart(2,"0"),second:t.getSeconds().toString().padStart(2,"0")})):($(new Date),l&&w({hour:"00",minute:"00",second:"00"}))))},[H,t,l,u,o]),s.useEffect(()=>{!H&&!u?(k(t),t&&($(t),l&&w({hour:t.getHours().toString().padStart(2,"0"),minute:t.getMinutes().toString().padStart(2,"0"),second:t.getSeconds().toString().padStart(2,"0")}))):!H&&u&&t&&w({hour:t.getHours().toString().padStart(2,"0"),minute:t.getMinutes().toString().padStart(2,"0"),second:t.getSeconds().toString().padStart(2,"0")})},[t,l,u,H]);const Z=()=>{if(u){const y=K(J(G(t||new Date,parseInt(D.hour,10)),parseInt(D.minute,10)),parseInt(D.second,10));a?.(y)}else if(o==="month")a?.(T?Y(T):void 0);else if(T){let f=T;l&&(f=G(f,parseInt(D.hour,10)),f=J(f,parseInt(D.minute,10)),f=K(f,parseInt(D.second,10))),a?.(f)}else a?.(void 0);F(!1)},O=()=>{k(U.current),$(L.current),l&&w(W.current),F(!1)},tt=s.useMemo(()=>{if(!t)return i;const f=r&&typeof r!="string"?{locale:r}:void 0;if(u)return/[Hhms]/.test(p)?R(t,p,f):R(t,"HH:mm:ss",f);if(o==="month"){if(r){const y=typeof r=="string"?r:r?.code||"en-US";return new Intl.DateTimeFormat(y,{month:"2-digit",year:"numeric"}).format(t)}return R(t,"MM/yyyy",f)}return l?/[Hhms]/.test(p)?R(t,p,f):R(t,`${p} HH:mm:ss`,f):R(t,p,f)},[t,p,l,u,o,i,r]),q=s.useCallback(f=>{if(g)return!0;const y=new Date;y.setHours(0,0,0,0);const A=new Date(f);return A.setHours(0,0,0,0),S&&A<y||C&&A>y?!0:N?N(f):!1},[g,S,C,N]),et=s.useMemo(()=>({...z,mode:"single",selected:T,onSelect:k,defaultMonth:P,month:P,onMonthChange:$,captionLayout:"dropdown",disabled:q,startMonth:new Date(1890,0,1),endMonth:new Date(new Date().getFullYear()+50,11,31),locale:r}),[z,T,P,q,r]),B=n.jsxs(ct,{open:H,onOpenChange:F,children:[n.jsx(it,{asChild:!0,children:n.jsxs(V,{variant:"outline",size:M,disabled:g,className:x("group w-full justify-between",!t&&"text-muted-foreground",d&&"border-destructive",E),children:[n.jsx("span",{children:tt}),n.jsx(rt,{className:"h-4 w-4 opacity-50"})]})}),n.jsx(at,{className:x("flex w-auto flex-col gap-2 p-0",e),align:"start",children:n.jsxs("div",{className:"flex flex-col gap-2 pb-2",children:[u?n.jsx("div",{className:"flex h-[350px]",children:n.jsx(Q,{value:D,onChange:w,className:"min-h-0 h-full shrink-0 w-full"})}):o==="month"?n.jsx("div",{className:"flex h-[350px]",children:n.jsx(lt,{value:T,onChange:k,locale:r,monthNames:_,disabled:q,className:"min-h-0 h-full shrink-0 w-full"})}):n.jsxs("div",{className:x("flex h-[350px]",l&&"overflow-hidden"),children:[n.jsx(ot,{initialFocus:!0,...et}),l&&n.jsx(Q,{value:D,onChange:w,className:"min-h-0 h-full shrink-0"})]}),n.jsx(nt,{className:"shrink-0"}),n.jsxs("div",{className:"flex justify-end gap-2 px-2 shrink-0",children:[n.jsx(V,{variant:"secondary",size:"sm",onClick:O,children:c||"Cancel"}),n.jsx(V,{size:"sm",onClick:Z,children:m||"Apply"})]})]})})]});return h||d?n.jsxs("div",{className:x("w-full",b),children:[h&&n.jsxs(st,{className:"text-foreground leading-5 block",children:[h,j&&n.jsx("span",{className:"text-destructive",children:"*"})]}),n.jsx("div",{className:h?"mt-1":"",children:B}),d&&n.jsx("div",{className:"text-destructive text-sm mt-1.5",role:"alert",children:d})]}):n.jsx("div",{className:x("w-full",b),children:B})}export{ht as D};
