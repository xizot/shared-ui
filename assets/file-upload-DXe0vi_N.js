import{y as V,r as f,j as t,o as y,a2 as _,q,s as G,z as X,a3 as H}from"./main-CmXVh1U4.js";import{P as J}from"./progress-BX9geAUk.js";import{X as Q}from"./x-6pHyXmX5.js";const Y=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],Z=V("file",Y);function R(l){if(l===0)return"0 Bytes";const m=1024,u=["Bytes","KB","MB","GB","TB","PB"],p=Math.floor(Math.log(l)/Math.log(m));return Math.round(l/Math.pow(m,p)*100)/100+" "+u[p]}function te({value:l=[],onChange:m,accept:u,multiple:p=!1,maxSize:g,maxFiles:j,disabled:i=!1,onError:F,showPreview:U=!0,showProgress:b=!1,className:$,dropzoneClassName:C,placeholder:D,uploadText:z}){const[L,w]=f.useState(!1),N=e=>e&&typeof e=="object"&&"name"in e&&"size"in e&&"type"in e&&"lastModified"in e&&!("file"in e),[c,v]=f.useState(()=>!l||l.length===0?[]:l.map(e=>N(e)?{file:e,preview:e.type.startsWith("image/")?URL.createObjectURL(e):void 0,status:"success"}:e)),x=f.useRef(null),h=f.useRef(c);f.useEffect(()=>{h.current=c},[c]),f.useEffect(()=>()=>{h.current.forEach(e=>{e.preview&&URL.revokeObjectURL(e.preview)})},[]),f.useEffect(()=>{if(!l||l.length===0){h.current.forEach(d=>{d.preview&&URL.revokeObjectURL(d.preview)}),h.current.length>0&&v([]);return}const e=l.map(s=>N(s)?s:s.file),r=h.current.map(s=>s.file),a=e.map(s=>`${s.name}-${s.size}`).join(","),o=r.map(s=>`${s.name}-${s.size}`).join(",");if(a===o&&e.length===r.length)return;h.current.forEach(s=>{s.preview&&URL.revokeObjectURL(s.preview)});const n=l.map(s=>N(s)?{file:s,preview:s.type.startsWith("image/")?URL.createObjectURL(s):void 0,status:"success"}:s);v(n)},[l]);const M=e=>{if(g&&e.size>g)return`File size exceeds ${R(g)}`;if(u){const r=u.split(",").map(s=>s.trim()),a=e.type,o=e.name.toLowerCase();if(!(r.some(s=>s.startsWith(".")?o.endsWith(s.toLowerCase()):s.endsWith("/*")?a.startsWith(s.slice(0,-1)):a===s||a.match(s.replace("*",".*")))||r.some(s=>o.endsWith(s.toLowerCase()))))return`File type not allowed. Accepted types: ${u}`}return null},k=e=>{const r=[],a=[];if(j&&c.length+e.length>j){const n=`Maximum ${j} file(s) allowed`;r.push(n),F?.(n);return}if(e.forEach(n=>{const s=M(n);if(s)r.push(`${n.name}: ${s}`),F?.(s);else{const d={file:n,preview:n.type.startsWith("image/")?URL.createObjectURL(n):void 0,status:"success"};a.push(d)}}),r.length>0&&a.length===0)return;const o=p?[...c,...a]:a;v(o),m?.(o.map(n=>n.file))},W=e=>{if(e.preventDefault(),e.stopPropagation(),w(!1),i)return;const r=Array.from(e.dataTransfer.files);r.length>0&&k(r)},O=e=>{e.preventDefault(),e.stopPropagation(),i||w(!0)},B=e=>{e.preventDefault(),e.stopPropagation(),w(!1)},E=e=>{const r=Array.from(e.target.files||[]);r.length>0&&k(r),x.current&&(x.current.value="")},I=e=>{const r=c[e];r.preview&&URL.revokeObjectURL(r.preview);const a=c.filter((o,n)=>n!==e);v(a),m?.(a.map(o=>o.file))},P=()=>{!i&&x.current&&x.current.click()},A=e=>e.type.startsWith("image/")?t.jsx(H,{className:"h-8 w-8 text-muted-foreground"}):t.jsx(Z,{className:"h-8 w-8 text-muted-foreground"});return t.jsxs("div",{className:y("w-full space-y-4",$),"data-slot":"file-upload",children:[t.jsxs("div",{onClick:P,onDrop:W,onDragOver:O,onDragLeave:B,className:y("relative flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer transition-colors",L&&!i&&"border-primary bg-primary/5",!L&&!i&&"border-input hover:border-primary/50 hover:bg-accent/50",i&&"cursor-not-allowed opacity-50",C),"data-slot":"file-upload-dropzone",children:[t.jsx("input",{ref:x,type:"file",accept:u,multiple:p,disabled:i,onChange:E,className:"hidden","data-slot":"file-upload-input"}),t.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[t.jsx(_,{className:y("h-8 w-8 mb-2",i?"text-muted-foreground":"text-primary")}),t.jsxs("p",{className:"mb-2 text-sm text-muted-foreground",children:[t.jsx("span",{className:"font-semibold",children:z||"Click to upload"}),!i&&" or drag and drop"]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[D||u||"Any file",p&&" (multiple files allowed)",g&&` (max ${R(g)})`]})]})]}),U&&c.length>0&&t.jsx("div",{className:"space-y-2","data-slot":"file-upload-list",children:c.map((e,r)=>{const{file:a,preview:o,progress:n,status:s,error:d}=e,T=a.type.startsWith("image/");return t.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg bg-card","data-slot":"file-upload-item",children:[t.jsx("div",{className:"flex-shrink-0",children:T&&o?t.jsx("img",{src:o,alt:a.name,className:"h-12 w-12 object-cover rounded","data-slot":"file-upload-preview"}):t.jsx("div",{className:"h-12 w-12 flex items-center justify-center bg-muted rounded",children:A(a)})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"text-sm font-medium truncate","data-slot":"file-upload-name",children:a.name}),s==="success"&&t.jsx(q,{className:"h-4 w-4 text-green-500 flex-shrink-0"}),s==="error"&&t.jsx(G,{className:"h-4 w-4 text-destructive flex-shrink-0"})]}),t.jsx("p",{className:"text-xs text-muted-foreground","data-slot":"file-upload-size",children:R(a.size)}),d&&t.jsx("p",{className:"text-xs text-destructive mt-1","data-slot":"file-upload-error",children:d}),b&&n!==void 0&&t.jsx("div",{className:"mt-2","data-slot":"file-upload-progress",children:t.jsx(J,{value:n,className:"h-1"})})]}),!i&&t.jsxs(X,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 flex-shrink-0",onClick:K=>{K.stopPropagation(),I(r)},"data-slot":"file-upload-remove",children:[t.jsx(Q,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Remove file"})]})]},`${a.name}-${r}`)})})]})}export{te as F};
